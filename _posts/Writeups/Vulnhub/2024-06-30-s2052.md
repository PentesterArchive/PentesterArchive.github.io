---
title: Writeup - S2-052 Dockerlabs.
categories: [Writeup, webExploitation]
tags: [Discovery, S2-052 , medium]
description: Writeup with a hard vulnerability discovery, after that we exploit CVE-2017-9805.
---

Download vulnerable target machine: [S2-052 - Vulnhub](https://www.vulnhub.com/entry/pentester-lab-s2-052,206/)

## Discovery.
### Port Scan.
The first step is allways to make a port scan and see which ports are opened, I like to use `nmap` to do so.
![img-description](/assets/img/writeups/2024/vulnhub/s2-052/1.png)

Port 80 `http` is open, now we can make a nmap version scan.
![img-description](/assets/img/writeups/2024/vulnhub/s2-052/2.png)

We can now open the browser to check what's in there and search for a vulnerability.
![img-description](/assets/img/writeups/2024/vulnhub/s2-052/3.png)

After a manual enumeration I couldn't find any vulnerability, at this time I tried to use automatic scaning tools.

### Automatic vulnerability scans.
#### Nikto.
The first tool I used was nikto, you can see the results of this scan in the next picture:

![img-description](/assets/img/writeups/2024/vulnhub/s2-052/4.png)

This scan was not enough for me and I thought I can make a better scan, then, proceed to perform an [Acunetix](#acunetix) scan.

#### Acunetix.
I started the service and ran it in `127.0.0.1:3443`.

![img-description](/assets/img/writeups/2024/vulnhub/s2-052/5.2.png)

![img-description](/assets/img/writeups/2024/vulnhub/s2-052/5.png)
_Adding the target._

![img-description](/assets/img/writeups/2024/vulnhub/s2-052/6.png)

We have some interesting results as we can see in the following pictures.
![img-description](/assets/img/writeups/2024/vulnhub/s2-052/7.png)
![img-description](/assets/img/writeups/2024/vulnhub/s2-052/8.png)
![img-description](/assets/img/writeups/2024/vulnhub/s2-052/9.png)

The target is vulnerable to `CVE-2017-9805` `Apache Struts2 (S2-052) RCE`.


## Exploitation
Now it's time to find an exploit and execute it. 
I found the next Github exploit [struts-pwn - CVE-2017-9805 Exploit](https://github.com/mazen160/struts-pwn_CVE-2017-9805).

![img-description](/assets/img/writeups/2024/vulnhub/s2-052/10.png)

I just followed the instructions and obtained a blind shell. I must say that I found some troubles trying to obtain a reverse shell.
![img-description](/assets/img/writeups/2024/vulnhub/s2-052/11.png)

We finally have acces and we are root user!

![img-description](/assets/img/writeups/2024/vulnhub/s2-052/12.png)

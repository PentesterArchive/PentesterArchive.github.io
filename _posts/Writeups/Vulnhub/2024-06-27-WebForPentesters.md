---
title: Vulnhub - Web For Pentesters I.
categories: [Writeup, webExploitation]
tags: [XSS, SQLI, Directory Traversal, LFI, CodeInjection, Command Injection, LDAP Attacks, File Upload, XXE, XPath]
description: In this Writeup we will face a lot of different Web vulnaberavilities to practise.
---

Download vulnerable target machine: [Vulnhub: Web for Pentesters](https://www.vulnhub.com/entry/pentester-lab-web-for-pentester,71/)

-------------------------


![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/0.png)


## XSS.

### Example 1.
<br />


![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss1.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss2.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss3.png)


### Example 2.
In this example if we try the last payload, the scripts tags are not being executed.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss2.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss2.2.png)<br />

Checking the source we can not see the `<script>` tags, let's try to bypass this using caps.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss2.3.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss2.5.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss2.4.png)




### Example 3.
In this example if we try the last payload, we have the same issue, the scripts tags are not being executed even if we use the last bypass.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss3.png)

We can not see the tags in the source:

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss3.1.png)<br />

The way to bypass this sanitization is to write a random string inside the script tag, here you can see two examples:

```javascript
<scr<script>ipt>alert(window.origin)</scr</script>ipt>
```

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss3.3.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss3.4.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss3.2.png)


### Example 4.
In the Example 4 we can not use the tag `<script>`.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss4.0.png)

We can use event handlers. This is just an example, but there are a lot more:

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss4.1.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss4.2.png)


### Example 5.

Now the problem is not in the tag, but we can not use the word `alert`.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss5.0.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss5.05.png)

We are going to bypass this defense using unicode characters, here you can check a full list: [unicode-table](https://symbl.cc/en/unicode-table/).

```javascript
<script>\u0061lert(window.origin)</script>
```

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss5.1.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss55.png)

### Example 6.

In this example we can not execute the payload because our input is being send inside `<script>` tags.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/XSS6.png)

In this case we must close the `<script>` tags and then insert our payload.

```javascript
</script><script>alert(window.origin)</script>
```
![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss6.2.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss6.3.png)



### Example 7.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss7.0.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss7.1.png)

```javascript
'; alert(window.origin);//
```

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss7.2.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss7.3.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss7.4.png)

### Example 8.

In example 8 we have a field to write our name. We can try to inject our regular payload there and see how is the web reacts to it.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss8.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss8.1.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss2.0.png)

The payload is being reflected in back in the front-end, it is not being executed. Let's check the source.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss8.3.png)

After seeing the source I saw that the `<>` characters aro not being interpreted, I tried some bypasses but nothing worked.

After those tries I realized that the web URL is being reflected in the source too (next image). Let's try to inject a test string and chek how the web reacts to it.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss8.4.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss8.5.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss8.6.png)

We can now read the string we injected, it's time to use a payload. 

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss8.7.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss8.8.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/XSS/xss8.9.png)

### Example 9.



----------------------

## SQL Injections

### Example 1.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/SQL/sql1.png)

```SQL
' OR '1'='1' -- -
```

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/SQL/sql1.2.png)




### Example 2.
If we try the itjection from [Example 1](#example-1) we get the next error:
![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/SQL/SQL2.png)

We can not use spaces in our injection, let's try to use `null bytes`, `%09`
```sql 
'%09OR%09'1'='1'%09--%09-
```

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/SQL/sql2.1.png)


### Example 3.

If we use the last payload we have a no Space Error. We have more types to bypass this sanitization. We can check more techniques in [HackTricks - No spaces Bypass](https://book.hacktricks.xyz/pentesting-web/sql-injection#no-spaces-bypass).

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/SQL/sqli3.1.png)

Let's try to bypass the space sanitization using `%A0` in our payload:
```plaintext
'%A0or%A0'1'='1'%A0--%A0-
```

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/SQL/sqli3.3.png)





### Example 4, Example 5, Example 6.
In this example we are facing another type of Query, the server is asking for the `id`, which is an integer.
In this cases we don't have to use `'` because the quotes are only used with strings.
![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/SQL/SQLI4.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/SQL/SQLI4.1.png)

__We can use this injection in Example 5 and Example 6 too.__


### Example 7.

In this example we get the next error:

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/SQL/sqli7.png)

The server is asking for an integer, so we are going to send the integer `2`, and then go to the next line `%0a` to insert there `or 1=1`

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/SQL/sqli7.1.png)


### Example 8.


### Example 9.





-------------------

### Directory traversal.



### Example 1.



### Example 2.



### Example 3.


-----------------

## File Include.

### Example 1.
The server is deploying the `intro.php` file, we can try to search for other files, like `/etc/passwd`

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/LFI/1.png)

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/LFI/1.1.png)




### Example 2.
In this case we are facing a sanitization, the server is concatenating .php to our input as we can see in the next error.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/LFI/2.png)

In old versions of `php` we can use a null byte `%00` to bypass the extension.

![img-description](/assets/img/writeups/2024/vulnhub/webForPentestersI/LFI/2.1.png)


------------------




------------------

## Commands Injection.

### Example 1.

### Example 2.

### Example 3.




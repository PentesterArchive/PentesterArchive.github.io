---
title: Writeup - Sau Hackthebox.
categories: [Writeup, webExploitation]
tags: [SSRF, Linux, SUID PE, easy]
description: Writeup exploiting two outdated services, finally we perform SUID privilege escalation.
---

Download vulnerable target machine: [Dark - Dockerlabs.es](https://mega.nz/file/Qft1jCjb#PlBLNl2jgetv_7jP9ycnsKnL4pabkeec55XWCXxbORk)

## Discovery
### Port scan.
![img-description](/assets/img/writeups/2024/hackTheBox/Sau/1.png)

![img-description](/assets/img/writeups/2024/hackTheBox/Sau/1.5.png)


Let's check what is the target hosting in the http service.
![img-description](/assets/img/writeups/2024/hackTheBox/Sau/2.png)

We see a basket creator functionality.
![img-description](/assets/img/writeups/2024/hackTheBox/Sau/4.png)

## Exploitation.

![img-description](/assets/img/writeups/2024/hackTheBox/Sau/5.png)

After checking the functionality I found the service name and version, `request-baskets version: 1.2.1`

![img-description](/assets/img/writeups/2024/hackTheBox/Sau/18.png)

I made a little search and found [request-baskets 1.2.1 SSRF Exploitation](https://github.com/entr0pie/CVE-2023-27163)

I downloaded the exploit and then execute the SSRF against port 80.
![img-description](/assets/img/writeups/2024/hackTheBox/Sau/8.png)

I found the next web:

![img-description](/assets/img/writeups/2024/hackTheBox/Sau/10.png)

Back again I found the service version `Maltrail (v0.53)` and I made a github search where I found the next exploit. [Maltrail0.53 - RCE](https://github.com/spookier/Maltrail-v0.53-Exploit/tree/main)

Let's use `nc` to wait for a connection and then run the exploit.
![img-description](/assets/img/writeups/2024/hackTheBox/Sau/11.png)

![img-description](/assets/img/writeups/2024/hackTheBox/Sau/13.png)


## Privilege Escalation.
As allways, I made a basic system enumeration to discover how to elevate privileges, I found that I can run `/usr/bin/systemctl status trail.service` as root without password.
![img-description](/assets/img/writeups/2024/hackTheBox/Sau/17.png)
_sudo -l_

As allways i referred to [gtfobins](https://gtfobins.github.io/gtfobins/systemctl/) and follow the instructions.

![img-description](/assets/img/writeups/2024/hackTheBox/Sau/19.png)

Finally we obtained the root user and capture the flag!

![img-description](/assets/img/writeups/2024/hackTheBox/Sau/16.png)

